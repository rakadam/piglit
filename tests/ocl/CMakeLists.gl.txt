include_directories(
  ${piglit_SOURCE_DIR}/tests
  ${piglit_SOURCE_DIR}/tests/util
)
link_libraries(
  piglitutil
  piglitutilocl
  OpenCL
  
  ${OPENGL_gl_LIBRARY}
  ${OPENGL_glu_LIBRARY}
  ${GLUT_glut_LIBRARY}  
)

macro(add_ocl_file file)
ADD_CUSTOM_COMMAND(OUTPUT ${file}.c
  COMMAND oclembed ${piglit_SOURCE_DIR}/tests/ocl/${file}
  DEPENDS oclembed ${file}
)
endmacro(add_ocl_file)

macro(add_ocl_test name c_src_file ocl_src_file)
add_ocl_file(${ocl_src_file})
add_executable(ocl-${name} ${c_src_file} ${ocl_src_file}.c)
endmacro(add_ocl_test)

macro(add_ocl_compile_test name)
add_ocl_test(compile-${name} context.c ${name}.ocl)
endmacro(add_ocl_compile_test)

macro(add_ocl_dual_test name)
add_ocl_compile_test(${name})
add_ocl_test(${name} ${name}.c ${name}.ocl)
endmacro(add_ocl_dual_test)

add_ocl_test(context context.c dummy.ocl)
add_ocl_test(allocate-global allocate-global.c dummy.ocl)
add_ocl_test(transfer-global transfer-global.c dummy.ocl)

add_ocl_dual_test(write-global)
add_ocl_dual_test(readwrite-global)
add_ocl_dual_test(indexed-global)
add_ocl_dual_test(indexed-readwrite-global)
add_ocl_dual_test(compare)
add_ocl_dual_test(branch)
add_ocl_dual_test(float-arithm)
add_ocl_dual_test(int-arithm)
add_ocl_dual_test(loop)


