include_directories(
  ${piglit_SOURCE_DIR}/tests
  ${piglit_SOURCE_DIR}/tests/util
)
link_libraries(
  piglitutil
  piglitutilocl
  OpenCL
  
  ${OPENGL_gl_LIBRARY}
  ${OPENGL_glu_LIBRARY}
  ${GLUT_glut_LIBRARY}  
)

macro(add_ocl_file file)
ADD_CUSTOM_COMMAND(OUTPUT ${file}.c
  COMMAND oclembed ${piglit_SOURCE_DIR}/tests/ocl/${file}
  DEPENDS oclembed ${file}
)
endmacro(add_ocl_file)

macro(add_ocl_test name c_src_file ocl_src_file)
add_ocl_file(${ocl_src_file})
add_executable(ocl-${name} ${c_src_file} ${ocl_src_file}.c)
endmacro(add_ocl_test)

macro(add_ocl_compile_test name)
add_ocl_test(compile-${name} context.c ${name}.ocl)
endmacro(add_ocl_compile_test)

add_ocl_test(context context.c dummy.ocl)
add_ocl_test(allocate-global allocate-global.c dummy.ocl)
add_ocl_test(transfer-global transfer-global.c dummy.ocl)
add_ocl_test(write-global write-global.c write-global.ocl)
add_ocl_test(readwrite-global readwrite-global.c readwrite-global.ocl)
add_ocl_test(indexed-global indexed-global.c indexed-global.ocl)
add_ocl_test(indexed-readwrite-global indexed-readwrite-global.c indexed-readwrite-global.ocl)
add_ocl_test(compare compare.c compare.ocl)
add_ocl_test(branch branch.c branch.ocl)
add_ocl_test(float-arithm float-arithm.c float-arithm.ocl)
add_ocl_test(int-arithm int-arithm.c int-arithm.ocl)
add_ocl_test(loop loop.c loop.ocl)

add_ocl_compile_test(readwrite-global)

